# Enable true color (24-bit) support
set -g default-terminal "tmux-256color"

# Tell tmux that the outer terminal (Ghostty) supports true color
set -ag terminal-overrides ",xterm-ghostty:RGB,ghostty:RGB"

# Fallback for other terminal types that support true color
set -ag terminal-overrides ",xterm-256color:RGB"

# Propagate COLORTERM to new sessions
set -ga update-environment " COLORTERM"

# Enable mouse support (scrolling, clicking, resizing)
set -g mouse on

# Allow programs (like Claude Code) to set window titles via escape sequences
set -g allow-rename on
set -g automatic-rename on

# Set terminal title to show tmux session and window info
set -g set-titles on
set -g set-titles-string "#S:#I:#W - #T"

# Status bar: show pane title (set by Claude Code) in window list
set -g status-interval 1
set -g window-status-format "#I:#W#{?#{!=:#{pane_title},#{host}}, - #{=30:pane_title},}"
set -g window-status-current-format "#I:#W#{?#{!=:#{pane_title},#{host}}, - #{=30:pane_title},}"

# Key binding: Ctrl-B Shift-N to create new window with Claude
# Find the last claude window and insert after it (keeps claude windows grouped at start)
bind-key N run-shell "tmux list-windows -F '#{window_index} #{window_name}' | awk '$2 ~ /^claude/ {last=$1} END {print last+1}' | xargs -I {} tmux new-window -t :{} -n claude -c '#{pane_current_path}' 'claude --dangerously-skip-permissions --model $CLAUDE_MODEL'"
